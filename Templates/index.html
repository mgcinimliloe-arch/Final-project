{% extends "layout.html" %}

{% block title %}Home - Trucking System{% endblock %}

{% block content %}
<h1 class="mb-4">Trucking Management System</h1>

<!-- Account Balance -->
<div class="alert alert-info">
    <strong>Current Account Balance:</strong> ${{ balance }}
</div>

<div class="row">
    <!-- Income Form -->
    <div class="col-md-4">
        <h4>Add Income</h4>
        <form method="POST">
            <input type="hidden" name="form_type" value="income">
            <div class="mb-2">
                <label>Truck ID</label>
                <input type="text" name="truck_id" class="form-control" required>
            </div>
            <div class="mb-2">
                <label>Amount</label>
                <input type="number" step="0.01" name="amount" class="form-control" required>
            </div>
            <div class="mb-2">
                <label>Note</label>
                <input type="text" name="note" class="form-control">
            </div>
            <button type="submit" class="btn btn-success">Add Income</button>
        </form>
    </div>

    <!-- Expense Form -->
    <div class="col-md-4">
        <h4>Add Expense</h4>
        <form method="POST">
            <input type="hidden" name="form_type" value="expense">
            <div class="mb-2">
                <label>Truck ID</label>
                <input type="text" name="truck_id" class="form-control" required>
            </div>
            <div class="mb-2">
                <label>Expense Type</label>
                <input type="text" name="expense_type" class="form-control" required>
            </div>
            <div class="mb-2">
                <label>Amount</label>
                <input type="number" step="0.01" name="amount" class="form-control" required>
            </div>
            <div class="mb-2">
                <label>Note</label>
                <input type="text" name="note" class="form-control">
            </div>
            <button type="submit" class="btn btn-danger">Add Expense</button>
        </form>
    </div>

    <!-- Balance Adjustment Form -->
    <div class="col-md-4">
        <h4>Balance Adjustment</h4>
        <form method="POST">
            <input type="hidden" name="form_type" value="adjustment">
            <div class="mb-2">
                <label>Amount (+/-)</label>
                <input type="number" step="0.01" name="amount" class="form-control" required>
            </div>
            <div class="mb-2">
                <label>Note</label>
                <input type="text" name="note" class="form-control">
            </div>
            <button type="submit" class="btn btn-warning">Adjust Balance</button>
        </form>
    </div>
</div>

<!-- Recent Transactions -->
<h3 class="mt-5">Recent Transactions</h3>
<table class="table table-striped">
    <thead>
    <tr>
        <th>#</th>
        <th>Type</th>
        <th>Truck ID</th>
        <th>Amount</th>
        <th>Expense Type</th>
        <th>Note</th>
        <th>Date</th>
    </tr>
    </thead>
    <tbody>
    {% for entry in history[-10:] %}
    <tr>
        <td>{{ loop.index }}</td>
        <td>{{ entry.type }}</td>
        <td>{{ entry.truck_id if entry.truck_id else '-' }}</td>
        <td>${{ entry.amount }}</td>
        <td>{{ entry.expense_type if entry.expense_type else '-' }}</td>
        <td>{{ entry.note if entry.note else '-' }}</td>
        <td>{{ entry.date.strftime("%Y-%m-%d %H:%M:%S") }}</td>
    </tr>
    {% endfor %}
    </tbody>
</table>

<a href="{{ url_for('history') }}" class="btn btn-primary">View Full History</a>
{% endblock %}
